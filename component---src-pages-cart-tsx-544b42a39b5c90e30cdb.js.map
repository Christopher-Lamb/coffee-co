{"version":3,"file":"component---src-pages-cart-tsx-544b42a39b5c90e30cdb.js","mappings":"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","sources":["webpack://my-gatsby-site/./src/pages/cart.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport type { HeadFC, PageProps } from \"gatsby\";\nimport { Navbar, Form, Input, BreadCrumbs, Payment, Information, Shipping, CheckoutNav, CheckChangeDisplay, OrderSummary, PortalOverlay } from \"../components\";\nimport { MdClose } from \"react-icons/md\";\nimport { getStoredCart, deleteFromCart, clearCart } from \"../utils/cartFunctions\";\nimport { Coffees } from \"../utils/coffees\";\nimport { Image } from \"../components\";\nimport { FiMinus } from \"react-icons/fi\";\nimport { IoMdAdd } from \"react-icons/io\";\nimport { useCoffeeContext } from \"../context/CoffeeContext\";\nimport { Helmet } from \"react-helmet\";\n\ninterface Item {\n  name: string;\n  quantity: number;\n  price: number;\n}\n\ninterface Coffee {\n  rating: number;\n  name: string;\n  roast: string;\n  origin: string;\n  filename: string;\n  notes: string[];\n  price: number;\n  weight: number;\n}\n\nconst capitalize = (str: string) => str.charAt(0).toUpperCase() + str.slice(1);\n\nconst shippingOptions: Record<string, number> = { \"Ground (2-6 business days)\": 0, \"3 Day Select (3 business days)\": 9, \"2nd Day Air (2-3 business days)\": 11, \"Next Day Air (2 business days)\": 21 };\n\nconst formatPrice = (num: number) => {\n  return new Intl.NumberFormat(\"en-US\", {\n    style: \"currency\",\n    currency: \"USD\",\n    minimumFractionDigits: 2, // Ensure two decimal places\n  }).format(num);\n};\n\nconst CartPage: React.FC<PageProps> = () => {\n  const [cartItems, setCartItems] = useState<Item[]>();\n  const [subtotal, setSubTotal] = useState(0);\n  const [storedFormData, setStoredFormData] = useState({ shipTo: \"\", email: \"\", shipping: \"Ground (2-6 business days)\", address: \"\" });\n  const [stepState, setStepState] = useState(\"information\");\n  const [isOrderSummary, setIsOrderSummary] = useState(false);\n\n  const { setCartAmt } = useCoffeeContext();\n\n  useEffect(() => {\n    const storedCart = getStoredCart();\n    setCartItems(storedCart);\n  }, []);\n  useEffect(() => {}, [storedFormData]);\n\n  const handleStoredFormData = (key: string, value: string) => {\n    setStoredFormData((prev) => ({ ...prev, [key]: value }));\n  };\n\n  const handleDelete = (itemIndex: number) => {\n    const arrCopy: Item[] = JSON.parse(JSON.stringify(cartItems));\n    arrCopy.splice(itemIndex, 1);\n    setCartAmt && setCartAmt((prev) => prev - 1);\n\n    deleteFromCart(itemIndex);\n    setCartItems(arrCopy);\n    calcSubtotal(arrCopy);\n  };\n\n  const handleQuantity = (index: number, value: number) => {\n    const arrCopy: Item[] = JSON.parse(JSON.stringify(cartItems));\n    const updatedCopy = arrCopy.map((item, i) => (index === i ? { ...item, quantity: value } : item));\n    setCartItems(updatedCopy);\n    calcSubtotal(updatedCopy);\n  };\n\n  const calcSubtotal = (updatedArr?: Item[]) => {\n    const items = updatedArr || cartItems;\n    // const shipPrice = parseFloat(shippingOptions.find(({ value, price }) => storedFormData.shipping === value)?.price.replace(\"$\", \"\") || \"0\") || 0;\n    const total = items?.reduce((prev, current, index, array) => prev + array[index].price * array[index].quantity, 0) || 0;\n\n    setSubTotal(total || 0);\n  };\n\n  const handleCloseSummary = () => {\n    //Clear cart\n    clearCart();\n    setCartAmt && setCartAmt(0);\n    window.location.replace(\"/\");\n  };\n\n  const handleChangeStep = (step: string) => {\n    if (step === \"confirm\") {\n      setIsOrderSummary(true);\n    }\n    setStepState(step);\n  };\n\n  return (\n    <>\n      <Helmet>\n        <title>{capitalize(stepState)} | Coffee Co. Cart</title>\n      </Helmet>\n      {isOrderSummary && (\n        <PortalOverlay>\n          <OrderSummary\n            onClose={handleCloseSummary}\n            subtotal={subtotal}\n            shipping={{ value: storedFormData[\"shipping\"], price: shippingOptions[storedFormData[\"shipping\"]] }}\n            items={cartItems || []}\n            address={storedFormData.address}\n          />\n        </PortalOverlay>\n      )}\n      <main className=\"pb-three\">\n        <Navbar />\n        <div className=\"max-w-five w-full min-h-four mx-auto bg-[#f7f7f7] flex\">\n          <div className=\" w-full flex flex-col justify-between\">\n            <div className=\"h-full\">\n              <div className=\"px-xsmall\">\n                <div className=\"pt-small pb-2xsmall border-b-2\">\n                  <div className=\"h-med w-med mb-3xsmall\">\n                    <Image fileName=\"beansLogo.png\" />\n                  </div>\n                  <BreadCrumbs value={stepState} onChange={(value) => setStepState(value)} />\n                </div>\n              </div>\n              <div>\n                <CheckChangeDisplay stepChange={(step) => setStepState(step)} step={stepState} stored={storedFormData} />\n              </div>\n              {/* <div>{stepMap[stepState]}</div> */}\n              <Information\n                onChange={(email, shipTo, address) => {\n                  handleStoredFormData(\"email\", email);\n                  handleStoredFormData(\"shipTo\", shipTo);\n                  handleStoredFormData(\"address\", address);\n                }}\n                step={stepState}\n              />\n              <Shipping\n                onChange={(shipping) => {\n                  handleStoredFormData(\"shipping\", shipping);\n                }}\n                step={stepState}\n              />\n              <Payment step={stepState} />\n            </div>\n            <div className=\" w-full h-large\">\n              <CheckoutNav step={stepState} options={[\"information\", \"shipping\", \"payment\"]} onChangeStep={handleChangeStep} />\n            </div>\n          </div>\n          <div className=\" w-full\">\n            <div className=\" h-2/3 p-xsmall\">\n              <div className=\"border bg-white flex flex-col gap-2xsmall overflow-y-auto h-full w-full p-2xsmall\">\n                {cartItems && cartItems?.length > 0 ? (\n                  cartItems?.map((item, index) => <CartItem key={index} onQuantityChange={handleQuantity} onDelete={handleDelete} {...item} index={index} />)\n                ) : (\n                  <div className=\"text-center text-gray-600 text-med mt-small\">No Coffee Items yetâ€¦</div>\n                )}\n              </div>\n            </div>\n            <div className=\"p-xsmall border-t-[1px]\">\n              <div className=\"flex justify-between text-2xl mt-1\">\n                <p>Subtotal</p>\n                <p>{formatPrice(subtotal)}</p>\n              </div>\n              {storedFormData.shipping && (\n                <div className=\"flex justify-between text-2xl mt-1\">\n                  <p>Shipping</p>\n                  <p>{formatPrice(shippingOptions[storedFormData.shipping])}</p>\n                </div>\n              )}\n              <div className=\"flex justify-between text-2xl mt-1\">\n                <p>Taxes</p>\n                <p>{formatPrice(subtotal * 0.06625)}</p>\n              </div>\n              <div className=\"flex justify-between text-3xl mt-2 border-t-[1px] pt-1 border-black\">\n                <p>Total</p>\n                <p>{formatPrice(shippingOptions[storedFormData.shipping] + subtotal + subtotal * 0.06625)}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    </>\n  );\n};\n\ninterface CartItemProps extends Item {\n  onDelete: (delIndex: number) => void;\n  index: number;\n  onQuantityChange: (index: number, value: number) => void;\n}\n\nconst CartItem: React.FC<CartItemProps> = ({ name, quantity, price, index, onDelete, onQuantityChange }) => {\n  const [coffeeState, setCoffeeState] = useState<Coffee>();\n\n  useEffect(() => {\n    const coffee = Coffees.find((item) => item.filename === name);\n    setCoffeeState(coffee);\n  }, []);\n\n  const handeDelete = () => {\n    onDelete(index);\n  };\n\n  const handleQuantity = (value: number) => {\n    onQuantityChange(index, value);\n  };\n\n  return (\n    <div className=\"h-large w-full flex\">\n      <Image fileName={name} className=\"h-large shrink-0 w-large\" />\n      <div className=\"flex justify-between w-full\">\n        <div className=\"flex flex-col justify-center p-2xsmall\">\n          <div>\n            <span className=\"capitalize\">\n              {coffeeState?.name} | {coffeeState?.roast} | {coffeeState?.origin}\n            </span>\n          </div>\n          <div>\n            <span>{formatPrice(price * quantity || 0)}</span>\n          </div>\n        </div>\n        <div className=\"flex items-center\">\n          <Quantity onChange={handleQuantity} initialValue={quantity} />\n          <button className=\"p-2xsmall ml-xsmall\" onClick={handeDelete}>\n            <MdClose size={\"1.5rem\"} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\ninterface QuantityProps {\n  onChange: (num: number) => void;\n  initialValue: number;\n}\nconst Quantity: React.FC<QuantityProps> = ({ onChange, initialValue }) => {\n  const [num, setNum] = useState(initialValue);\n\n  useEffect(() => {\n    onChange(num);\n  }, [num]);\n\n  const handleAdd = () => {\n    const newNum = num + 1 > 10 ? 10 : num + 1;\n    setNum(newNum);\n  };\n\n  const handleSubtract = () => {\n    const newNum = num - 1 < 1 ? num : num - 1;\n    setNum(newNum);\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = parseInt(e.target.value);\n    setNum(1);\n    if (e.target.value === \"\") return;\n\n    let newNum = 10 >= value && value >= 1 ? value : num;\n    if (value >= 10) newNum = 10;\n    if (value <= 1) newNum = 1;\n    setNum(newNum);\n  };\n\n  return (\n    <div className=\"flex flex-col items-center justify-between bg-white border w-med rounded \">\n      <a onClick={handleAdd} className=\"cursor-pointer flex justify-center items-center bg-gray-200 w-full h-2xsmall\">\n        <IoMdAdd size={\"1.3rem\"} />\n      </a>\n      <input value={num} name=\"quantity\" type=\"number\" min={1} max={10} className=\"w-full h-small text-center\" onChange={handleChange} />\n      <a onClick={handleSubtract} className=\"cursor-pointer flex justify-center items-center h-2xsmall w-full bg-gray-200\">\n        <FiMinus size={\"1.3rem\"} />\n      </a>\n    </div>\n  );\n};\n\nexport default CartPage;\n\nexport const Head: HeadFC = () => <title>Cart</title>;\n"],"names":["shippingOptions","formatPrice","num","Intl","NumberFormat","style","currency","minimumFractionDigits","format","CartItem","_ref","name","quantity","price","index","onDelete","onQuantityChange","coffeeState","setCoffeeState","useState","useEffect","coffee","Coffees","find","item","filename","React","className","Image","fileName","roast","origin","Quantity","onChange","value","initialValue","onClick","handeDelete","MdClose","size","_ref2","setNum","handleAdd","IoMdAdd","type","min","max","e","parseInt","target","newNum","handleSubtract","FiMinus","CartPage","cartItems","setCartItems","subtotal","setSubTotal","storedFormData","setStoredFormData","shipTo","email","shipping","address","stepState","setStepState","isOrderSummary","setIsOrderSummary","setCartAmt","useCoffeeContext","storedCart","getStoredCart","handleStoredFormData","key","prev","handleDelete","itemIndex","arrCopy","JSON","parse","stringify","splice","deleteFromCart","calcSubtotal","handleQuantity","updatedCopy","map","i","updatedArr","items","total","reduce","current","array","Helmet","str","charAt","toUpperCase","slice","PortalOverlay","OrderSummary","onClose","handleCloseSummary","clearCart","window","location","replace","Navbar","BreadCrumbs","CheckChangeDisplay","stepChange","step","stored","Information","Shipping","Payment","CheckoutNav","options","onChangeStep","length","Object","assign","Head"],"sourceRoot":""}